# 공지사항 관리 시스템 - 전체 테스트 시나리오

## 1. 시스템 개요

### 1.1 시스템 목적
- 무분별한 공지 메일 발송을 방지
- 승인 기반의 공지 발송 체계 수립
- 메일 발송 및 캘린더 연동

### 1.2 주요 기능
| 기능 | 설명 |
|------|------|
| 공지 등록 | 공지 유형, 내용, 수신자 등록 |
| 승인 관리 | 공지 승인/반려 프로세스 |
| 예약 발송 | 지정된 시간에 공지 발송 |
| 묶음 발송 | 동일 시각의 공지를 함께 발송 |
| 메일 발송 | 실제 이메일 발송 |
| 캘린더 연동 | Outlook 캘린더에 자동 등록 |
| 발송 결과 조회 | 발송 성공/실패 추적 |

### 1.3 주요 사용자
- **공지 작성자**: 공지 등록, 수정
- **승인 관리자**: 승인/반려 결정
- **일반 사용자**: 공지 조회
- **시스템 관리자**: 대시보드 모니터링

---

## 2. 시스템 아키텍처 흐름

```
┌─────────────────────────────────────────────────────────────────────┐
│                          클라이언트 (React)                          │
│  - 공지 등록 화면                                                   │
│  - 승인 대기 목록                                                   │
│  - 캘린더 화면                                                      │
│  - 대시보드                                                         │
└────────────┬────────────────────────────────────────────────────────┘
             │
             │ HTTP REST API
             │
┌────────────▼────────────────────────────────────────────────────────┐
│                    Spring Cloud Gateway (11000)                      │
│                                                                      │
│  ┌──────────────────┐  ┌──────────────────┐  ┌──────────────────┐ │
│  │  App API         │  │  Cloud Discovery │  │  Cloud Actuator  │ │
│  │  (8001)          │  │  (서비스 레지스트)│  │  (상태 모니터링) │ │
│  │                  │  │                  │  │                  │ │
│  │ ┌──────────────┐ │  │ ┌──────────────┐ │  │ ┌──────────────┐ │ │
│  │ │ Controllers  │ │  │ │ Service Reg  │ │  │ │ Health Check │ │ │
│  │ └──────┬───────┘ │  │ └──────────────┘ │  │ └──────────────┘ │ │
│  └────────┼─────────┘  └──────────────────┘  └──────────────────┘ │
│           │                                                         │
└───────────┼─────────────────────────────────────────────────────────┘
            │
   ┌────────┴────────┬──────────────┬──────────────┐
   │                 │              │              │
┌──▼──────────────┐ │              │              │
│ Spring Core     │ │              │              │
│ (공통 모듈)      │ │              │              │
│                 │ │              │              │
│ ┌─────────────┐ │ │              │              │
│ │ HTTP Util   │ │ │              │              │
│ │ -ErrorResp  │ │ │              │              │
│ │ -PageResp   │ │ │              │              │
│ └─────────────┘ │ │              │              │
│                 │ │              │              │
│ ┌─────────────┐ │ │              │              │
│ │ Functional  │ │ │              │              │
│ │ -Matcher    │ │ │              │              │
│ │ -Enhancer   │ │ │              │              │
│ └─────────────┘ │ │              │              │
└─────────────────┘ │              │              │
                    │              │              │
        ┌───────────▼──────┐      │              │
        │   Data Core      │      │              │
        │ (공통 JPA 설정)   │      │              │
        └───────────┬──────┘      │              │
                    │             │              │
        ┌───────────▼──────┐      │              │
        │   Data Temp      │      │              │
        │ (공지 데이터)     │      │              │
        │                  │      │              │
        │ ┌──────────────┐ │      │              │
        │ │ Entity       │ │      │              │
        │ │ -Notice      │ │      │              │
        │ │ -Approval    │ │      │              │
        │ │ -SendSchedule│ │      │              │
        │ └──────────────┘ │      │              │
        │                  │      │              │
        │ ┌──────────────┐ │      │              │
        │ │ Repository   │ │      │              │
        │ │ (DB Access)  │ │      │              │
        │ └──────────────┘ │      │              │
        │                  │      │              │
        │ ┌──────────────┐ │      │              │
        │ │ Service      │ │      │              │
        │ │ -Approval    │ │      │              │
        │ │ -SendSchedule│ │      │              │
        │ │ -Mail        │ │      │              │
        │ │ -Calendar    │ │      │              │
        │ └──────────────┘ │      │              │
        └──────────────────┘      │              │
                                  │              │
                                  ▼              │
                        ┌──────────────────┐     │
                        │ Mail Service     │     │
                        │ (메일 발송)       │     │
                        └──────────────────┘     │
                                                 ▼
                                        ┌──────────────────┐
                                        │ Calendar Service │
                                        │ (Outlook 연동)    │
                                        └──────────────────┘

        ┌───────────────────────────────┴──────────────────┐
        │                                                  │
        ▼                                                  ▼
┌─────────────────┐                              ┌─────────────────┐
│   Database      │                              │   External API  │
│   (MySQL/Oracle)│                              │   (Outlook API) │
│                 │                              │   (ASKME API)   │
│ ┌─────────────┐ │                              └─────────────────┘
│ │ NOTICE      │ │
│ │ APPROVAL    │ │
│ │ SEND_SCHEDULE
│ │ NOTIFICATION│ │
│ └─────────────┘ │
└─────────────────┘
```

---

## 3. 핵심 비즈니스 프로세스

### 3.1 공지 등록 프로세스
```
┌─────────┐
│ 시작    │
└────┬────┘
     │
     ▼
┌─────────────────────────┐
│ 공지 작성자             │
│ - 공지 유형 선택        │
│   (ASKME에서 수집)      │
│ - 발신 부서 확인        │
│   (자동 입력)           │
│ - 수신 대상 선택        │
│   (법인/부서/사용자)    │
│ - 공지 제목/내용 입력   │
│ - 해시태그 등록         │
│ - 첨부파일 등록         │
└────┬────────────────────┘
     │
     ▼
┌─────────────────────────┐
│ 상태 변경               │
│ DRAFT → PENDING         │
│ (대기 중)               │
└────┬────────────────────┘
     │
     ▼
┌─────────────────────────┐
│ 승인 담당자에게 알림    │
│ 이메일/시스템 알림 발송 │
└────┬────────────────────┘
     │
     ▼
┌─────────┐
│ 완료    │
└─────────┘
```

### 3.2 승인 관리 프로세스
```
┌─────────────────────────────────────────┐
│ 승인 관리자 - 공지 목록 조회            │
│ (상태: PENDING)                         │
└────┬────────────────────────────────────┘
     │
     ├─────────────────────────┬──────────────────────┐
     │                         │                      │
     ▼                         ▼                      ▼
┌─────────┐            ┌─────────────┐      ┌─────────────┐
│ 승인    │            │ 내용 검토   │      │ 반려        │
│ APPROVED│            │ (추가 정보  │      │ REJECTED    │
└────┬────┘            │  요청)      │      └────┬────────┘
     │                 └─────┬───────┘            │
     │                       │                    │
     │                   ┌───▼────────┐           │
     │                   │ 작성자 수정 │           │
     │                   │ 재승인 신청 │           │
     │                   └───┬────────┘           │
     │                       │                    │
     │                   ┌───▼────────┐           │
     │                   │ 다시 검토   │           │
     │                   └───┬────────┘           │
     │                       │                    │
     │          ┌────────────┘                    │
     │          │                                 │
     ▼          ▼                                 ▼
┌────────────────────┐              ┌──────────────────────┐
│ 승인 이력 기록      │              │ 반려 이력 기록       │
│ (Append-only)      │              │ (Append-only)       │
│ - 승인자            │              │ - 반려자             │
│ - 승인 시각         │              │ - 반려 사유          │
│ - 비고              │              │ - 반려 시각          │
└────┬───────────────┘              └────┬─────────────────┘
     │                                    │
     ▼                                    ▼
┌────────────────────┐              ┌──────────────────────┐
│ 다음 프로세스       │              │ 공지 작성자에 알림   │
│ 진행 가능           │              │ (반려 사유 포함)     │
│ (발송 예약 등)      │              │                      │
└────────────────────┘              └──────────────────────┘
```

### 3.3 예약 발송 프로세스
```
┌──────────────────────────┐
│ 공지 등록자              │
│ 발송 일시 설정           │
│ (현재시각 이후만 가능)   │
└────┬─────────────────────┘
     │
     ▼
┌────────────────────────────┐
│ 유효성 검증                │
│ DPR-04: 예약시각 >= 현재   │
│ DPR-01: 승인 상태 확인     │
│ DPR-03: 종료된 공지 체크   │
└────┬───────────────────────┘
     │
     ├─── 검증 실패 ──→ ❌ 에러 반환
     │
     │ (검증 성공)
     ▼
┌────────────────────────────┐
│ 발송 일정 저장             │
│ SEND_SCHEDULE 테이블       │
│ - notice_id                │
│ - scheduled_time           │
│ - status: SCHEDULED        │
└────┬───────────────────────┘
     │
     ▼
┌────────────────────────────┐
│ 스케줄 확인 (백그라운드)   │
│ 예약 시간 도래 시          │
└────┬───────────────────────┘
     │
     ▼
┌────────────────────────────┐
│ 묶음 발송 확인             │
│ 동일 시각의 공지 검색      │
│ (DPR-05)                   │
└────┬───────────────────────┘
     │
     ▼
┌────────────────────────────┐
│ 이메일 발송                │
│ Mail Service 호출          │
└────┬───────────────────────┘
     │
     ├─── 발송 성공 ──→ status: SENT
     │                └─→ 캘린더 연동 진행
     │
     └─── 발송 실패 ──→ status: FAILED
                      └─→ 재시도 로직
```

### 3.4 메일 발송 프로세스
```
┌──────────────────────┐
│ Mail Service         │
│ sendNotice() 호출    │
└────┬─────────────────┘
     │
     ▼
┌──────────────────────────────────────┐
│ 이메일 컨텐츠 생성                   │
│ - 공지 제목                          │
│ - 공지 내용                          │
│ - 수신 대상 목록                     │
│ - 캘린더 링크 (있으면)               │
└────┬─────────────────────────────────┘
     │
     ▼
┌──────────────────────────────────────┐
│ SMTP 연결 및 발송                    │
│ (설정된 메일 서버로)                 │
└────┬─────────────────────────────────┘
     │
     ├─── 성공 ──→ ✅ 발송 기록
     │            └─→ SendResult 저장
     │            └─→ status: SENT
     │
     └─── 실패 ──→ ❌ 에러 기록
                  └─→ SendResult 저장
                  └─→ status: FAILED
                  └─→ 에러 메시지 저장
```

### 3.5 캘린더 연동 프로세스
```
┌───────────────────────────────────────┐
│ 공지 발송 완료                        │
│ (Mail Service 성공)                   │
└────┬────────────────────────────────┬─┘
     │                                │
     ▼                                ▼
┌─────────────────────┐      ┌──────────────────────┐
│ 캘린더 연동 여부    │      │ 다음 공지 진행       │
│ DPR-07 체크         │      │                      │
│                     │      └──────────────────────┘
│ 캘린더 대상인가?    │
└────┬────────────────┘
     │
     ├─── 아니오 ──→ 끝
     │
     │ (예)
     ▼
┌────────────────────────────────────┐
│ Outlook API 호출                   │
│ createCalendarEvent()              │
│                                    │
│ 요청 파라미터:                     │
│ - 공지 제목                        │
│ - 시작 시간 (발송 시각)            │
│ - 종료 시간 (1시간)                │
│ - 초대 대상 (수신자)               │
│ - 공지 본문 (설명)                 │
└────┬─────────────────────────────┬─┘
     │                             │
     ├─── 성공 ──→ ✅ 캘린더 생성
     │            └─→ calendar_link 저장
     │            └─→ status: CALENDAR_CREATED
     │
     └─── 실패 ──→ ❌ 에러 기록
                  └─→ calendar_link = NULL
                  └─→ status: CALENDAR_FAILED
                  └─→ 수동 확인 필요
```

---

## 4. 데이터 모델

### 4.1 주요 테이블 관계

```
NOTICE (공지)
├── id (PK)
├── title
├── content
├── notice_type_id → NOTICE_TYPE
├── sender_dept_id → DEPARTMENT
├── status (DRAFT/PENDING/APPROVED/REJECTED/SENT/COMPLETED)
├── created_at
├── updated_at
└── hash_tags

APPROVAL (승인)
├── id (PK)
├── notice_id → NOTICE (FK)
├── approver_id → USER
├── status (APPROVED/REJECTED)
├── reason
├── approval_history (Append-only)
├── created_at
└── approved_at

SEND_SCHEDULE (발송 일정)
├── id (PK)
├── notice_id → NOTICE (FK)
├── scheduled_time
├── status (SCHEDULED/SENT/FAILED)
├── calendar_link
├── created_at
└── sent_at

SEND_RESULT (발송 결과)
├── id (PK)
├── send_schedule_id → SEND_SCHEDULE (FK)
├── recipient_id → USER
├── recipient_email
├── status (SENT/FAILED)
├── error_message
└── sent_at

NOTIFICATION (알림)
├── id (PK)
├── notify_to_id → USER
├── related_notice_id → NOTICE
├── type (APPROVAL_REQUEST/APPROVAL_RESULT)
├── is_read
└── created_at

NOTICE_RECIPIENT (공지 수신자)
├── id (PK)
├── notice_id → NOTICE (FK)
├── recipient_id → USER
├── recipient_type (CORPORATE/DEPT/USER/SERVICE)
└── created_at
```

---

## 5. 테스트 시나리오

### 5.1 기본 흐름 테스트 (Happy Path)

#### TC-001: 공지 등록부터 발송까지 전체 흐름
**전제 조건:**
- 로그인된 공지 작성자 (user@corp.com)
- 승인 관리자 (approver@corp.com)
- 2026-02-05 09:00 기준

**테스트 단계:**
1. 공지 등록
   - 공지 유형: "서비스 공지"
   - 발신 부서: "IT팀" (자동)
   - 제목: "새로운 시스템 출시 안내"
   - 내용: "2026-02-20 신규 시스템이 출시됩니다..."
   - 수신 대상: 전사 (선택)
   - 예상 결과: DRAFT 상태로 저장

2. 승인 요청
   - 공지 상태: DRAFT → PENDING
   - 승인자에게 알림 발송
   - 예상 결과: PENDING 상태, 알림 기록

3. 승인 담당자 검토
   - 공지 내용 확인
   - "승인" 클릭
   - 예상 결과: APPROVED 상태, 승인 이력 저장

4. 발송 일시 설정
   - 예약 발송: 2026-02-20 10:00
   - 예상 결과: SEND_SCHEDULE 테이블에 기록

5. 자동 발송 (스케줄러 실행)
   - 2026-02-20 10:00 도래
   - 메일 발송
   - 예상 결과: status SENT, SEND_RESULT 기록

6. 캘린더 연동
   - Outlook API 호출
   - 캘린더 이벤트 생성
   - 예상 결과: calendar_link 저장, CALENDAR_CREATED

**예상 결과:**
- ✅ 공지 상태: COMPLETED
- ✅ 발송 결과: 성공
- ✅ 캘린더: 생성됨
- ✅ 사용자에게 메일 수신
- ✅ 발송 이력 조회 가능

---

#### TC-002: 반려 후 재승인 프로세스
**전제 조건:**
- TC-001 진행 중 승인 단계에서 반려

**테스트 단계:**
1. 승인 담당자가 공지 반려
   - 반려 사유: "발송 시기 조정 필요"
   - 상태: PENDING → REJECTED

2. 공지 작성자에게 알림 발송
   - 반려 사유 포함
   - 수정 요청

3. 공지 작성자가 내용 수정
   - 공지 내용 수정
   - 재승인 신청
   - 상태: REJECTED → PENDING

4. 재심사 후 승인
   - 승인 담당자 검토
   - 승인
   - 상태: PENDING → APPROVED

**예상 결과:**
- ✅ 반려/재승인 이력 기록 (append-only)
- ✅ 최종적으로 APPROVED 상태
- ✅ 발송 진행 가능

---

#### TC-003: 묶음 발송
**전제 조건:**
- 승인된 공지 3개
- 모두 동일 발송 시각: 2026-02-20 10:00

**테스트 단계:**
1. 스케줄러 실행 시 동일 시각 공지 검색
   - 예상 결과: 3개 공지 그룹화

2. 묶음 메일 생성
   - 수신자별 최적화
   - 단일 이메일 또는 그룹 메일

3. 발송 실행
   - 예상 결과: 3개 공지 동시 발송

**예상 결과:**
- ✅ DPR-05 준수
- ✅ 발송 효율성 증대
- ✅ 각각의 발송 결과 기록

---

### 5.2 예외 처리 테스트

#### TC-004: 과거 시각 예약 시도
**전제 조건:**
- 공지 승인됨
- 현재 시각: 2026-02-05 09:00

**테스트 단계:**
1. 발송 시각 설정: 2026-02-03 10:00 (과거)
2. 저장 시도

**예상 결과:**
- ❌ 에러 메시지: "예약 시각은 현재 이후여야 합니다"
- ❌ DPR-04 위반
- ❌ SEND_SCHEDULE 저장 실패

---

#### TC-005: 승인 전 발송 시도
**전제 조건:**
- 공지 상태: PENDING (아직 미승인)

**테스트 단계:**
1. 발송 버튼 클릭

**예상 결과:**
- ❌ 에러 메시지: "승인 완료 후에만 발송 가능합니다"
- ❌ DPR-01 위반
- ❌ 발송 프로세스 진행 안 함

---

#### TC-006: 메일 발송 실패
**전제 조건:**
- 공지 승인됨
- 예약 시각 도래
- SMTP 서버 연결 실패 시뮬레이션

**테스트 단계:**
1. 스케줄러 실행
2. 메일 발송 시도
3. 연결 실패 발생

**예상 결과:**
- ❌ status: FAILED
- ❌ SEND_RESULT에 에러 메시지 기록
- ❌ 재시도 로직 실행
- ❌ 캘린더 연동 스킵

---

#### TC-007: 캘린더 연동 실패
**전제 조건:**
- 메일 발송: 성공
- Outlook API: 실패 시뮬레이션

**테스트 단계:**
1. 캘린더 이벤트 생성 시도
2. API 연결 실패

**예상 결과:**
- ⚠️ status: CALENDAR_FAILED (또는 SENT)
- ⚠️ calendar_link: NULL
- ⚠️ 에러 로그 기록
- ⚠️ DPR-07: 캘린더 링크 누락 상태 완료 불가 (정책 확인 필요)

---

#### TC-008: 종료된 공지 수정 시도
**전제 조건:**
- 공지 상태: COMPLETED (발송 완료)

**테스트 단계:**
1. 공지 내용 수정 시도

**예상 결과:**
- ❌ 에러 메시지: "종료된 공지는 수정할 수 없습니다"
- ❌ DPR-03 위반
- ❌ 수정 불가

---

#### TC-009: 발송 완료 후 재발송 시도
**전제 조건:**
- 공지 발송 완료
- status: SENT

**테스트 단계:**
1. 발송 일정 변경 시도

**예상 결과:**
- ❌ 에러 메시지: "발송 완료된 공지는 변경 불가합니다"
- ❌ DPR-06 위반
- ⚠️ 재발송은 새 공지로 생성 필요

---

#### TC-010: 승인 이력 변경 시도
**전제 조건:**
- 공지 승인 이력 존재

**테스트 단계:**
1. 데이터베이스에서 직접 이력 수정 시도

**예상 결과:**
- ❌ 데이터베이스 제약 조건 위반
- ❌ DPR-08: Append-only 정책 준수
- ✅ 이력 불변성 보장

---

### 5.3 통합 테스트

#### TC-011: 다양한 수신 대상 테스트
**전제 조건:**
- 공지 1개

**테스트 단계:**
1. 수신 대상 설정
   - 법인: "본사" (200명)
   - 부서: "IT팀" (50명)
   - 사용자: "김철수@corp.com", "이영희@corp.com"
   - 서비스: "공지서비스" (100명)

2. 메일 발송
   - 예상 결과: 350명에게 발송 (중복 제외)

**예상 결과:**
- ✅ SEND_RESULT: 350개 레코드
- ✅ 각각 발송 여부 기록
- ✅ 조회 가능

---

#### TC-012: 에러 응답 포맷 검증
**전제 조건:**
- 모든 에러 시나리오 발생

**테스트 단계:**
1. 각 에러 상황에서 에러 응답 확인

**예상 결과:**
- ✅ ErrorResponse 포맷 일관성
- ✅ errorId 포함 (추적 가능)
- ✅ 상태 코드 정확성
- ✅ 에러 메시지 명확성
- ✅ stackTrace (필요시)

---

### 5.4 성능/부하 테스트

#### TC-013: 대량 공지 발송
**전제 조건:**
- 공지 1000개
- 수신자 각 100명
- 동일 발송 시각

**테스트 단계:**
1. 스케줄러 실행
2. 동시 발송

**예상 결과:**
- ✅ 묶음 발송으로 효율화
- ✅ 데이터베이스 성능 모니터링
- ✅ 메일 서버 부하 관리
- ✅ 응답 시간 < 5초

---

#### TC-014: 동시 승인 요청
**전제 조건:**
- 공지 여러 개 동시 승인 요청

**테스트 단계:**
1. 여러 사용자가 동시에 공지 등록/승인

**예상 결과:**
- ✅ 동시성 제어 (Lock/Transaction)
- ✅ 데이터 일관성 보장
- ✅ 중복 처리 없음

---

### 5.5 보안 테스트

#### TC-015: 권한 검증
**전제 조건:**
- 일반 사용자 계정
- 승인 권한 없음

**테스트 단계:**
1. 승인 버튼 클릭 시도
2. 타인의 공지 수정 시도

**예상 결과:**
- ❌ 403 Forbidden
- ❌ "권한이 없습니다" 메시지

---

#### TC-016: SQL Injection 방지
**전제 조건:**
- 공지 검색 입력 필드

**테스트 단계:**
1. 입력: `'; DROP TABLE NOTICE; --`

**예상 결과:**
- ✅ PreparedStatement 사용
- ✅ 특수문자 이스케이프
- ✅ SQL Injection 방지

---

#### TC-017: XSS 방지
**전제 조건:**
- 공지 제목/내용 입력 필드

**테스트 단계:**
1. 입력: `<script>alert('XSS')</script>`

**예상 결과:**
- ✅ HTML 이스케이프
- ✅ 스크립트 실행 안 됨
- ✅ `&lt;script&gt;` 로 표시

---

## 6. 데이터 검증 규칙

| 필드 | 유효성 검사 | 예시 |
|------|-----------|------|
| 공지 제목 | 필수, 1~200자 | "새로운 시스템 출시" |
| 공지 내용 | 필수, 1~5000자 | 상세 설명 |
| 공지 유형 | 필수, 기존 값만 | "서비스 공지" |
| 수신 대상 | 최소 1개 | ["법인:본사", "사용자:kim@"] |
| 해시태그 | 선택, 최대 5개 | "#긴급 #시스템" |
| 예약 시각 | 선택, 현재 이후 | 2026-02-20 10:00 |
| 발신 부서 | 필수, 자동 입력 | "IT팀" |

---

## 7. 테스트 실행 환경

### 7.1 테스트 스택
```
├─ 단위 테스트 (Unit Test)
│  ├─ ErrorResponse 테스트
│  ├─ Entity 검증 테스트
│  ├─ Service 비즈니스 로직 테스트
│  └─ Repository 쿼리 테스트
│
├─ 통합 테스트 (Integration Test)
│  ├─ Controller 엔드포인트 테스트
│  ├─ 데이터베이스 트랜잭션 테스트
│  ├─ 외부 API 모의 테스트 (Mock)
│  └─ 전체 흐름 시나리오 테스트
│
├─ API 테스트 (API Test)
│  ├─ Swagger 자동 테스트
│  ├─ Postman 스크립트
│  └─ RestAssured 테스트
│
└─ 부하 테스트 (Load Test)
   ├─ JMeter 스크립트
   ├─ 동시 사용자 100명 시뮬레이션
   └─ 응답 시간 측정
```

### 7.2 테스트 도구
- **JUnit 5**: 단위 테스트
- **Mockito**: Mock 객체
- **RestAssured**: REST API 테스트
- **TestContainers**: DB 테스트 컨테이너
- **Wiremock**: 외부 API Mock
- **JMeter**: 부하 테스트

### 7.3 테스트 수행 명령어
```bash
# 전체 테스트
./gradlew test

# 특정 테스트 클래스
./gradlew test --tests ErrorResponseTest

# 통합 테스트만
./gradlew test --tests "*IntegrationTest"

# 커버리지 리포트
./gradlew test jacocoTestReport
```

---

## 8. 모니터링 및 로깅

### 8.1 핵심 로깅 포인트
```
1. 공지 등록
   - [INFO] Notice created: id={id}, title={title}, status=DRAFT

2. 승인 요청
   - [INFO] Approval requested: notice_id={id}, approver={approver}

3. 승인 완료
   - [INFO] Notice approved: notice_id={id}, approver={approver}

4. 발송 일정 등록
   - [INFO] Send schedule created: id={id}, scheduled_time={time}

5. 메일 발송
   - [INFO] Email sent: notice_id={id}, recipients={count}
   - [ERROR] Email send failed: {error_message}

6. 캘린더 연동
   - [INFO] Calendar event created: calendar_link={link}
   - [ERROR] Calendar sync failed: {error_message}
```

### 8.2 메트릭 수집
- 공지 발송 성공률
- 평균 승인 시간
- 메일 발송 지연 시간
- 캘린더 연동 성공률
- 에러 발생 빈도

---

## 9. 배포 체크리스트

- [ ] 모든 단위 테스트 통과
- [ ] 통합 테스트 통과
- [ ] 코드 커버리지 > 80%
- [ ] 보안 검사 통과
- [ ] 성능 테스트 통과 (응답 시간 < 1초)
- [ ] 문서화 완료
- [ ] 데이터베이스 마이그레이션 스크립트 검증
- [ ] 배포 전 Staging 환경 테스트
- [ ] 실제 메일/캘린더 API 연동 확인
- [ ] 모니터링 시스템 활성화

---

## 10. 트러블슈팅 가이드

### 문제: 메일 발송 실패
**원인 검토:**
1. SMTP 설정 확인
2. 메일 서버 연결 확인
3. 인증 정보 검증
4. 네트워크 방화벽 확인

### 문제: 캘린더 연동 실패
**원인 검토:**
1. Outlook API 키 확인
2. OAuth2 토큰 유효성
3. 캘린더 권한 확인
4. API 요청 형식 검증

### 문제: 승인 알림 미수신
**원인 검토:**
1. 알림 발송 로직 확인
2. 메일 서버 큐 확인
3. 수신자 이메일 주소 검증
4. 스팸 필터 확인

---

**문서 작성일**: 2026-02-05
**버전**: 1.0
**작성자**: QA Team
